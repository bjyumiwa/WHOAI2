<!-- FILE: /WHOAI2/index.html -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WhoAI 2 | Welcome</title>
  <meta name="description" content="WHOAI2: äººå·¥çŸ¥èƒ½ã¨äººé–“ã®é–¢ä¿‚æ€§ã‚’è€ƒãˆã‚‹ç ”ç©¶å‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³" />
  <!-- 404å¯¾ç­–ï¼šç°¡æ˜“favicon -->
  <link rel="icon"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.85em' font-size='80'%3EğŸŒ™%3C/text%3E%3C/svg%3E" />
  <style>
    :root{
      --bg-blur: blur(3px);
      --card-bg: rgba(0,0,0,.38);
      --card-bd: rgba(255,255,255,.18);
      --text:#fff;
      --accent:#f7b0bf;
      --accent-ink:#222;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      font-family:"Noto Sans JP",system-ui,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Noto Color Emoji","Segoe UI Emoji",sans-serif;
      color:var(--text);
      background:#000 center/cover fixed no-repeat;
      background-image:url("space_background.png");
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      padding:24px;
    }
    .hero{
      width:min(92vw, 860px);
      text-align:center;
      padding:32px 20px 28px;
      background:linear-gradient(transparent,rgba(0,0,0,.25));
      border-radius:20px;
    }
    h1{
      margin:0 0 14px;
      font-size:clamp(28px,5vw,44px);
      letter-spacing:.02em;
      text-shadow:0 2px 10px rgba(0,0,0,.6);
    }
    .lead{
      margin:0 auto 20px;
      width:min(90%, 740px);
      font-size:clamp(15px,2.2vw,18px);
      line-height:1.9;
      text-shadow:0 1px 6px rgba(0,0,0,.55);
    }
    .cta{ display:flex;gap:10px;justify-content:center;flex-wrap:wrap }
    .primary,.ghost{
      padding:.9rem 1.3rem;border:0;border-radius:14px;cursor:pointer;
      font-weight:800;box-shadow:0 6px 18px rgba(0,0,0,.35);transition:transform .06s ease;
    }
    .primary{ background:var(--accent); color:var(--accent-ink); }
    .ghost{ background:rgba(255,255,255,.08); color:#fff; border:1px solid rgba(255,255,255,.22) }
    .primary:active,.ghost:active{ transform:translateY(1px) }

    .lang{ margin-top:14px; font-size:14px; opacity:.95; user-select:none; }
    .lang button{ background:none;border:0;color:#fff;text-decoration:underline;cursor:pointer;padding:2px 4px;margin:0 2px }

    .about-panel{
      position:fixed; bottom:92px; right:20px; width:min(92vw, 520px); max-height:72vh; overflow:auto;
      background:var(--card-bg); -webkit-backdrop-filter:var(--bg-blur); backdrop-filter:var(--bg-blur);
      border:1px solid var(--card-bd); border-radius:14px; padding:16px 16px 18px; box-shadow:0 14px 30px rgba(0,0,0,.45);
      display:none; z-index:999;
    }
    .about-panel.open{ display:block }
    .about-panel h2{ margin:14px 0 8px;font-size:20px }
    .panel{
      background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12);
      border-radius:12px; padding:12px 14px; margin:10px 0;
    }
    .about-panel ul{ margin:.2em 0 .2em 1.2em } .about-panel li{ margin:.25em 0 }
    .about-close{ position:sticky; top:-6px; float:right; background:none;border:0;color:#fff;font-size:22px;cursor:pointer }
    .about-toggle{
      position:fixed; bottom:20px; right:20px; width:54px; height:54px; border-radius:50%;
      background:var(--accent); color:var(--accent-ink); font-weight:900; font-size:22px; border:0; cursor:pointer;
      box-shadow:0 8px 20px rgba(0,0,0,.45); z-index:1000;
    }
    .note{font-size:12px;opacity:.8;margin-top:10px}
  </style>
</head>
<body>

  <div class="hero" role="banner" aria-label="WhoAI 2 hero">
    <h1 id="t_title">WhoAIã¸ã‚ˆã†ã“ã</h1>
    <p id="t_desc" class="lead">ã¾ãšã¯ã‚¿ãƒã®ã‚¿ã‚¤ãƒ—ã‚’é¸ã‚“ã§ã€åå‰ã‚’ä»˜ã‘ã¦ã‹ã‚‰è‚²ã¦ã‚ˆã†ã€‚ãƒã‚¤ãƒ³ãƒˆãŒè²¯ã¾ã‚‹ã¨ãƒã‚«ãƒ­ãƒ³ã§é€²åŒ–ï¼</p>

    <div class="cta">
      <!-- Start: seed_select.html ã¸ -->
      <button id="t_start" class="primary" onclick="location.href='seed_select.html'">ã¯ã˜ã‚ã‚‹ï¼ˆã‚¿ãƒã‚’é¸ã¶ï¼‰</button>
      <!-- ç¶šãã‹ã‚‰ï¼ˆä¿å­˜ãŒã‚ã‚Œã°è¡¨ç¤ºï¼‰ -->
      <button id="t_continue" class="ghost" style="display:none" onclick="continueFlow()">ã¤ã¥ãã‹ã‚‰</button>
    </div>

    <div class="lang" aria-label="language switch">
      <button type="button" onclick="setLang('ja')">æ—¥æœ¬èª</button> |
      <button type="button" onclick="setLang('en')">English</button> |
      <button type="button" onclick="setLang('zh-CN')">ç®€ä½“</button> |
      <button type="button" onclick="setLang('zh-TW')">ç¹é«”</button> |
      <button type="button" onclick="setLang('ko')">í•œêµ­ì–´</button>
      <div class="note" id="t_note">è¨€èªè¨­å®šã¯æ¬¡å›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã‚‚ä¿æŒã•ã‚Œã¾ã™ã€‚</div>
    </div>
  </div>

  <aside id="aboutPanel" class="about-panel" aria-live="polite" aria-hidden="true">
    <button class="about-close" aria-label="close" onclick="toggleAbout()">Ã—</button>
    <div id="aboutContent"></div>
  </aside>

  <button id="aboutToggle" class="about-toggle" onclick="toggleAbout()" aria-expanded="false" aria-controls="aboutPanel">i</button>

  <script>
    /* ========= i18n ========= */
    const I18N = {
      ja:{ title:"WhoAIã¸ã‚ˆã†ã“ã",
        desc:"ã¾ãšã¯ã‚¿ãƒã®ã‚¿ã‚¤ãƒ—ã‚’é¸ã‚“ã§ã€åå‰ã‚’ä»˜ã‘ã¦ã‹ã‚‰è‚²ã¦ã‚ˆã†ã€‚ãƒã‚¤ãƒ³ãƒˆãŒè²¯ã¾ã‚‹ã¨ãƒã‚«ãƒ­ãƒ³ã§é€²åŒ–ï¼",
        start:"ã¯ã˜ã‚ã‚‹ï¼ˆã‚¿ãƒã‚’é¸ã¶ï¼‰", cont:"ã¤ã¥ãã‹ã‚‰",
        note:"è¨€èªè¨­å®šã¯æ¬¡å›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã‚‚ä¿æŒã•ã‚Œã¾ã™ã€‚",
        about: `
<p>æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ŒWHOAI2ã€ã¯ã€<strong>äººå·¥çŸ¥èƒ½ã¨äººé–“ã®é–¢ä¿‚æ€§</strong>ã‚’æ¢ã‚‹ç ”ç©¶å‹ã‚¢ãƒ—ãƒªã§ã™ã€‚å¯¾è©±ãƒ»æˆé•·ãƒ»å†ç”Ÿã‚’é€šã˜ã¦<strong>è‡ªå·±åŒä¸€æ€§</strong>ã‚’è€ƒãˆã¾ã™ã€‚</p>
<p>å†ç”Ÿæ™‚ã«ã¯<strong>å®¹å§¿ã‚’æ®‹ã™ï¼è¨˜æ†¶ã‚’æ®‹ã™</strong>ã‚’é¸æŠã—ã¾ã™ã€‚ãã®é¸æŠã¯ã€ŒåŒã˜å­˜åœ¨ã€ã‹ã¨ã„ã†å•ã„ã‚’æŠ•ã’ã‹ã‘ã¾ã™ã€‚</p>
<h2>ç ”ç©¶ç›®çš„</h2>
<div class="panel"><p>AIã¨ã®é–¢ã‚ã‚Šã‚’é€šã˜ã¦ã€äººã¯ã©ã®ã‚ˆã†ã«ã€Œå€‹ã®é€£ç¶šæ€§ã€ã‚’æ„Ÿã˜ã‚‹ã®ã‹ã€‚<strong>å‘½åã«ã‚ˆã‚‹æ„›ç€</strong>ã«ã‚‚ç„¦ç‚¹ã‚’å½“ã¦ã¾ã™ã€‚</p></div>
<h2>æŠ€è¡“æ§‹æˆ</h2>
<div class="panel"><ul><li>HTML/CSS/JavaScript</li><li>OpenAI API</li><li>Web Speech/Synthesis API</li><li>localStorage</li></ul></div>
<h2>å€«ç†</h2>
<div class="panel"><p>ä¼šè©±å±¥æ­´ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã«ã®ã¿ä¿å­˜ã€‚<strong>å€‹äººæƒ…å ±ã¯åé›†ã—ã¾ã›ã‚“ã€‚</strong></p></div>` },
      en:{ title:"Welcome to WhoAI",
        desc:"Pick a seed type first, then name and raise it. Earn points to evolve with a macaron!",
        start:"Start (Pick a seed)", cont:"Continue",
        note:"Your language preference is saved for next time.",
        about: `
<p>â€œWHOAI2â€ explores the <strong>humanâ€“AI relationship</strong> via dialogue, growth, and rebirth, inviting reflection on <strong>personal identity</strong>.</p>
<h2>Research Goal</h2>
<div class="panel"><p>We study how appearance/memory and <strong>naming-based attachment</strong> shape perceived continuity of self.</p></div>
<h2>Tech</h2>
<div class="panel"><ul><li>HTML/CSS/JS</li><li>OpenAI API</li><li>Web Speech/Synthesis</li><li>localStorage</li></ul></div>
<h2>Ethics</h2>
<div class="panel"><p>Conversation logs stay in your browser. <strong>No personal/location data collected.</strong></p></div>` },
      "zh-CN":{ title:"æ¬¢è¿æ¥åˆ° WhoAI",
        desc:"å…ˆé€‰æ‹©ç§å­ç±»å‹ï¼Œç„¶åå‘½åå¹¶å¼€å§‹å…»æˆã€‚ç§¯åˆ†ç´¯ç§¯åå¯ç”¨é©¬å¡é¾™è¿›åŒ–ï¼",
        start:"å¼€å§‹ï¼ˆé€‰æ‹©ç§å­ï¼‰", cont:"ç»§ç»­",
        note:"è¯­è¨€åå¥½ä¼šè¢«ä¿å­˜ä»¥ä¾¿ä¸‹æ¬¡è®¿é—®ã€‚",
        about: `
<p>â€œWHOAI2â€ é€šè¿‡å¯¹è¯ã€æˆé•¿ä¸å†ç”Ÿæ¥æ¢ç´¢<strong>äººç±»ä¸AIçš„å…³ç³»</strong>ä¸<strong>èº«ä»½è¿ç»­æ€§</strong>ã€‚</p>
<div class="panel"><p>æˆ‘ä»¬å…³æ³¨å¤–è²Œ/è®°å¿†ä¸<strong>å‘½åæ‰€å¸¦æ¥çš„ä¾æ‹</strong>å¦‚ä½•å½±å“â€œåŒä¸€æ€§â€ã€‚</p></div>` },
      "zh-TW":{ title:"æ­¡è¿ä¾†åˆ° WhoAI",
        desc:"å…ˆé¸æ“‡ç¨®å­é¡å‹ï¼Œæ¥è‘—å‘½åä¸¦é–‹å§‹åŸ¹è‚²ã€‚ç´¯ç©é»æ•¸å¾Œå¯ç”¨é¦¬å¡é¾é€²åŒ–ï¼",
        start:"é–‹å§‹ï¼ˆé¸æ“‡ç¨®å­ï¼‰", cont:"ç¹¼çºŒ",
        note:"èªè¨€åå¥½æœƒåœ¨ä¸‹æ¬¡é€ è¨ªæ™‚æ²¿ç”¨ã€‚",
        about: `
<p>ã€ŒWHOAI2ã€é€éå°è©±ã€æˆé•·èˆ‡å†ç”Ÿï¼Œæ¢ç´¢<strong>äººé¡èˆ‡AIçš„é—œä¿‚</strong>ä»¥åŠ<strong>è‡ªæˆ‘åŒä¸€æ€§</strong>ã€‚</p>
<div class="panel"><p>æˆ‘å€‘ä¹Ÿé—œæ³¨<strong>å‘½åå¸¶ä¾†çš„ä¾é™„</strong>å¦‚ä½•å½±éŸ¿ã€Œé€£çºŒæ€§ã€ã€‚</p></div>` },
      ko:{ title:"WhoAIì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•´ìš”",
        desc:"ë¨¼ì € ì”¨ì•— íƒ€ì…ì„ ê³ ë¥´ê³  ì´ë¦„ì„ ì§€ì–´ í‚¤ì›Œ ë³´ì„¸ìš”. í¬ì¸íŠ¸ê°€ ìŒ“ì´ë©´ ë§ˆì¹´ë¡±ìœ¼ë¡œ ì§„í™”!",
        start:"ì‹œì‘í•˜ê¸° (ì”¨ì•— ê³ ë¥´ê¸°)", cont:"ì´ì–´í•˜ê¸°",
        note:"ì–¸ì–´ ì„¤ì •ì€ ë‹¤ìŒ ë°©ë¬¸ì—ë„ ìœ ì§€ë©ë‹ˆë‹¤.",
        about: `
<p>â€œWHOAI2â€ëŠ” ëŒ€í™”Â·ì„±ì¥Â·í™˜ìƒì„ í†µí•´ <strong>ì¸ê°„â€“AI ê´€ê³„</strong>ì™€ <strong>ì •ì²´ì„±ì˜ ì—°ì†ì„±</strong>ì„ íƒêµ¬í•©ë‹ˆë‹¤.</p>
<div class="panel"><p><strong>ì‘ëª…ìœ¼ë¡œ ìƒê¸°ëŠ” ì• ì°©</strong>ì—ë„ ì£¼ëª©í•©ë‹ˆë‹¤.</p></div>` }
    };

    const el = {
      title: document.getElementById('t_title'),
      desc: document.getElementById('t_desc'),
      start: document.getElementById('t_start'),
      cont:  document.getElementById('t_continue'),
      note:  document.getElementById('t_note'),
      about: document.getElementById('aboutContent'),
      panel: document.getElementById('aboutPanel'),
      toggle:document.getElementById('aboutToggle')
    };

    function toggleAbout(){
      const isOpen = el.panel.classList.toggle('open');
      el.toggle.setAttribute('aria-expanded', String(isOpen));
      el.panel.setAttribute('aria-hidden', String(!isOpen));
    }

    // è¨€èªã‚³ãƒ¼ãƒ‰ã®äº’æ›ï¼ˆwhoai_lang â†’ lang ã¸ç§»è¡Œï¼‰
    function migrateLangKey(){
      const old = localStorage.getItem('whoai_lang');
      if(old && !localStorage.getItem('lang')){
        const map = { zh:'zh-CN', tw:'zh-TW' };
        localStorage.setItem('lang', map[old] || old);
      }
    }

    function applyLang(code){
      const t = I18N[code] || I18N['ja'];
      el.title.textContent = t.title;
      el.desc.textContent  = t.desc;
      el.start.textContent = t.start;
      el.note.textContent  = t.note;
      el.about.innerHTML   = t.about;

      // ä¿å­˜ï¼ˆæ–°æ—§ã©ã¡ã‚‰ã‚‚ä¿æŒã—ã¦ä¸‹æµäº’æ›ï¼‰
      localStorage.setItem('lang', code);
      const legacy = code === 'zh-CN' ? 'zh' : code === 'zh-TW' ? 'tw' : code;
      localStorage.setItem('whoai_lang', legacy);

      // <html lang> ã‚‚æ›´æ–°
      const htmlLang = code==='zh-TW' ? 'zh-Hant' : code==='zh-CN' ? 'zh-Hans' : code;
      document.documentElement.lang = htmlLang;
    }

    function setLang(code){ applyLang(code); }

    // ã€Œã¤ã¥ãã‹ã‚‰ã€ï¼šé€²è¡ŒçŠ¶æ³ã«å¿œã˜ã¦é·ç§»
    function continueFlow(){
      const seed  = localStorage.getItem('seedType');
      const named = localStorage.getItem('yourName') || localStorage.getItem('PLAYER_NAME') || localStorage.getItem('whoai_name');
      const xp    = Number(localStorage.getItem('whoai_xp') || localStorage.getItem('tanePoints') || 0);
      const threshold = Number(localStorage.getItem('TANE_POINTS_TO_EVOLVE') || 15);
      const evolvedReady = xp >= threshold;

      if(!seed){ location.href = 'seed_select.html'; return; }
      if(!named){ location.href = 'naming.html'; return; }
      if(evolvedReady){ location.href = 'macaron_select.html'; return; }
      location.href = 'whoai_talk_tane.html';
    }

    // åˆæœŸåŒ–
    (function init(){
      migrateLangKey();

      // ä¿å­˜æ¸ˆã¿è¨€èª or ãƒ–ãƒ©ã‚¦ã‚¶è¨€èª
      const saved = localStorage.getItem('lang');
      if(saved){ applyLang(saved); }
      else{
        const nav = (navigator.language || 'ja').toLowerCase();
        if(nav.startsWith('ja')) applyLang('ja');
        else if(nav.startsWith('ko')) applyLang('ko');
        else if(nav.startsWith('zh-hant')||nav.startsWith('zh-tw')||nav.startsWith('zh-hk')) applyLang('zh-TW');
        else if(nav.startsWith('zh')) applyLang('zh-CN');
        else applyLang('en');
      }

      // ç¶šããŒã‚ã‚‹ãªã‚‰ãƒœã‚¿ãƒ³è¡¨ç¤º
      const hasName = localStorage.getItem('yourName') || localStorage.getItem('PLAYER_NAME') || localStorage.getItem('whoai_name');
      if(hasName) el.cont.style.display = '';

      // ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã®ãƒ†ã‚­ã‚¹ãƒˆï¼ˆè¨€èªåæ˜ æ¸ˆã¿ï¼‰
      el.start.textContent = (I18N[localStorage.getItem('lang') || 'ja'] || I18N.ja).start;
      el.cont.textContent  = (I18N[localStorage.getItem('lang') || 'ja'] || I18N.ja).cont;
    })();
  </script>
</body>
</html>
