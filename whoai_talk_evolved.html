<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>会話 | WhoAI（進化後）</title>
  <style>
    html,body { height:100%; margin:0 }
    body {
      font-family:"Noto Sans JP", sans-serif;
      background:url("space_background.png") center/cover fixed no-repeat;
      display:flex; flex-direction:column; align-items:center;
      color:#fff;
    }
    .chat { flex:1; width:100%; max-width:600px; overflow-y:auto; padding:10px; }
    .bubble { max-width:75%; margin:5px; padding:10px;
      border-radius:16px; line-height:1.4; }
    .me { background:#4cafef; align-self:flex-end; }
    .ai { background:#666; align-self:flex-start; }
    .input-row { display:flex; width:100%; max-width:600px; margin:10px; }
    input { flex:1; padding:10px; border-radius:8px; border:none; }
    button { padding:10px; margin-left:8px; border:none; border-radius:8px; background:#f5a; color:#fff; }
  </style>
</head>
<body>
  <h2>進化キャラと会話しよう</h2>
  <div class="chat" id="chat"></div>
  <div class="input-row">
    <input id="msg" placeholder="メッセージを入力…" />
    <button id="send">送信</button>
  </div>

  <script>
    const KEY_NAME = "whoai_name";
    const TALK_ENDPOINT = "YOUR_API_ENDPOINT";
    const chat = document.getElementById("chat");
    const input = document.getElementById("msg");

    function addBubble(text, cls){
      const div = document.createElement("div");
      div.className = "bubble "+cls;
      div.textContent = text;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    document.getElementById("send").addEventListener("click", async ()=>{
      const msg = input.value.trim();
      if(!msg) return;
      addBubble(msg,"me");
      input.value="";
      try {
        const res = await fetch(TALK_ENDPOINT,{method:"POST",body:JSON.stringify({msg})});
        const data = await res.json();
        addBubble(data.reply || "…","ai");
      } catch(e){ addBubble("エラー","ai"); }
    });
  </script>
</body>
</html>
