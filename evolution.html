<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ÈÄ≤ÂåñÊºîÂá∫ | WhoAI</title>
<meta name="color-scheme" content="dark light" />
<style>
  html,body{height:100%;margin:0;overflow:hidden}
  body{
    font-family:"Noto Sans JP",system-ui,sans-serif;color:#fff;
    background:#000 url("space_background.png") center/cover fixed no-repeat;
    display:flex;align-items:center;justify-content:center;padding:12px;
  }
  .stage{
    position:relative; width:min(92vw,860px); aspect-ratio:1/0.75;
    border-radius:24px; overflow:hidden;
    background:rgba(0,0,0,.22);
    backdrop-filter:blur(3px); -webkit-backdrop-filter:blur(3px);
    border:1px solid rgba(255,255,255,.18);
    box-shadow:0 10px 28px rgba(0,0,0,.25), inset 0 10px 28px rgba(0,0,0,.25);
  }
  .beam{
    position:absolute; inset:0; pointer-events:none; opacity:0;
    background:radial-gradient(60% 40% at 50% 30%, rgba(255,255,255,.45), rgba(255,255,255,0)),
               radial-gradient(40% 25% at 50% 60%, rgba(125,200,255,.35), rgba(0,0,0,0));
    mix-blend-mode:screen; filter:blur(2px);
    animation: beam 2.6s ease-out .2s both;
  }
  @keyframes beam{0%{opacity:0;transform:scale(1.05)}20%{opacity:.9}70%{opacity:.75}100%{opacity:0;transform:scale(1)}}
  .charWrap{
    position:absolute; left:50%; top:58%; transform:translate(-50%,-50%) scale(.7);
    filter:drop-shadow(0 12px 26px rgba(0,0,0,.5));
    animation: pop 1200ms cubic-bezier(.2,.9,.2,1.05) .4s both, breathe 6s ease-in-out 1.8s infinite;
  }
  @keyframes pop{0%{transform:translate(-50%,-50%) scale(.1);opacity:0}60%{transform:translate(-50%,-50%) scale(1.1);opacity:1}100%{transform:translate(-50%,-50%) scale(1)}}
  @keyframes breathe{0%,100%{transform:translate(-50%,-50%) scale(1)}50%{transform:translate(-50%,-50%) scale(1.04)}}
  .charImg{ width:min(28vw,260px); max-width:42vmin; object-fit:contain }
  .fallback{position:absolute;left:50%;top:58%;transform:translate(-50%,-50%);
            background:rgba(0,0,0,.55);padding:8px 12px;border-radius:12px;
            border:1px solid rgba(255,255,255,.2);font-weight:700;display:none}

  .cta{
    position:absolute; left:0; right:0; bottom:16px;
    display:flex; gap:10px; justify-content:center; flex-wrap:wrap;
    opacity:0; transform:translateY(16px);
    transition:opacity .5s ease, transform .5s ease;
  }
  .cta.show{ opacity:1; transform:none }
  .btn{appearance:none;border:none;border-radius:14px;cursor:pointer;
       padding:10px 14px;font-weight:800;font-size:clamp(14px,2.5vw,16px);
       box-shadow:0 6px 18px rgba(0,0,0,.28)}
  .btn-primary{background:#fff;color:#111}
  .btn-ghost{background:rgba(255,255,255,.18);color:#fff;border:1px solid rgba(255,255,255,.28)}
  .head{position:absolute;left:0;right:0;top:10px;text-align:center;font-weight:700;
        text-shadow:0 2px 6px rgba(0,0,0,.35)}
</style>
</head>
<body>
  <main class="stage">
    <div class="head">ÈÄ≤Âåñ„Åó„Åü„ÇàÔºÅ</div>
    <div class="beam" aria-hidden="true"></div>
    <div class="charWrap">
      <img id="charImg" class="charImg" alt="evolved character" />
      <div id="fallback" class="fallback">(ÁîªÂÉèÊú™ÈÖçÁΩÆ) tane„Åß‰ª£Áî®‰∏≠</div>
    </div>

    <div id="cta" class="cta" aria-live="polite" aria-label="Ê¨°„ÅÆË°å„ÅçÂÖà„ÇíÈÅ∏Êäû">
      <button id="btnObserve" class="btn btn-ghost" type="button">üëÄ Ë¶≥ÂØü„Çí„Å§„Å•„Åë„Çã</button>
      <button id="btnTalk" class="btn btn-primary" type="button">üí¨ ‰ºöË©±„Åô„ÇãÔºàWhoAIÔºâ</button>
    </div>
  </main>

<script>
  // Ëâ≤„ÅØ whoai_color „Åã macaronColor „ÅÆ„Å©„Å°„Çâ„Åã
  const color = (localStorage.getItem('whoai_color') || localStorage.getItem('macaronColor') || 'pink').toLowerCase();

  // Áõ¥‰∏ãÈÅãÁî®Ôºö/WHOAI2/ „Å´ÁîªÂÉè„Åå„ÅÇ„ÇãÂâçÊèêÔºàÁõ∏ÂØæ„Åß„ÇÇOKÔºâ
  const candidates = [
    `${color}_closed.png`,
    `${color}_open.png`,
    `tane_${color}.png`
  ];

  function setWithFallback(imgEl, badgeEl, arr){
    let i=0;
    function next(){
      if(i>=arr.length){ imgEl.style.display='none'; badgeEl.style.display='block'; return; }
      const url=arr[i++]; imgEl.onerror=next; imgEl.onload=()=>{ badgeEl.style.display='none'; }; imgEl.src=url;
    }
    next();
  }
  setWithFallback(document.getElementById('charImg'), document.getElementById('fallback'), candidates);

  // CTAË°®Á§∫
  setTimeout(()=>document.getElementById('cta').classList.add('show'), 2600);

  // Ë°å„ÅçÂÖà
  document.getElementById('btnObserve').addEventListener('click', ()=>location.href='whoai_talk_evolved.html');
  document.getElementById('btnTalk').addEventListener('click', ()=>location.href='whoai_talk.html');
</script>
</body>
</html>
