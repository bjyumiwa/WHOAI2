<!-- FILE: /WHOAI2/seed_select.html -->
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>ã‚¿ãƒã‚’é¸ã¶ | WhoAI</title>
<meta name="color-scheme" content="dark light" />
<link rel="icon"
  href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.85em' font-size='80'%3EğŸŒ±%3C/text%3E%3C/svg%3E" />
<style>
  :root{--fg:#fff;--glass:rgba(0,0,0,.45);--line:rgba(255,255,255,.2);--accent:#7ac7ff;--ink:#00283e}
  *{box-sizing:border-box}
  html,body{height:100%;margin:0}
  body{
    font-family:"Noto Sans JP",system-ui,sans-serif;color:var(--fg);
    background:#000 url("space_background.png") center/cover fixed no-repeat;
    display:flex;flex-direction:column;align-items:center;justify-content:center;gap:18px;padding:16px;
  }
  h1{margin:0;font-size:clamp(22px,4.5vw,30px);text-shadow:0 2px 10px rgba(0,0,0,.55)}
  .lead{opacity:.9;margin:0}
  .wrap{width:min(960px,94vw)}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:10px}
  .card{
    background:var(--glass);backdrop-filter:blur(4px);border:1px solid var(--line);
    border-radius:16px;padding:16px;cursor:pointer;display:flex;align-items:center;gap:12px;
    transition:transform .06s ease, outline .06s ease; outline:2px solid transparent;
  }
  .card:hover{transform:translateY(-1px)}
  .card.selected{outline:2px solid var(--accent)}
  .emoji{font-size:28px}
  .name{font-size:18px;font-weight:800}
  .desc{font-size:12px;opacity:.9;margin-top:2px}
  .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
  .btn{padding:10px 16px;border-radius:12px;font-weight:800;cursor:pointer;border:0;box-shadow:0 6px 18px rgba(0,0,0,.35)}
  .primary{background:var(--accent);color:var(--ink)}
  .ghost{background:rgba(255,255,255,.1);color:#fff;border:1px solid var(--line)}
  .btn:active{transform:translateY(1px)}
  .primary:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}
  @media (max-width:520px){ .grid{grid-template-columns:1fr} }

  /* ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒªãƒ³ã‚¯ï¼ˆå¸¸æ™‚è¡¨ç¤ºâ†’JSæˆåŠŸæ™‚ã«éš ã™ï¼‰ */
  .fallback{margin-top:14px}
  .fallback a{
    display:inline-block;margin:4px;padding:10px 14px;border-radius:12px;
    border:1px solid var(--line);background:var(--glass);color:#fff;text-decoration:none;
  }
  .fallback.hidden{display:none}

  /* å³ä¸‹ã®ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ */
  .reset{
    position:fixed;right:16px;bottom:16px;background:rgba(255,255,255,.1);
    border:1px solid var(--line);color:#fff;border-radius:12px;padding:8px 12px;cursor:pointer
  }
</style>
</head>
<body>
  <div class="wrap">
    <h1 id="title">æœ€åˆã®ã‚¿ãƒã‚’é¸ã‚“ã§ãã ã•ã„</h1>
    <p class="lead" id="lead">ã‚ã¨ã‹ã‚‰å¤‰æ›´ã§ãã¾ã™ã€‚é¸ã‚“ã ã‚¿ã‚¤ãƒ—ã¯æ€§æ ¼ãƒ»è¦‹ãŸç›®ã®ãƒ™ãƒ¼ã‚¹ã«ãªã‚Šã¾ã™ã€‚</p>

    <div class="grid" id="choices"><!-- JS ã§å·®ã—è¾¼ã¿ --></div>

    <div class="actions">
      <button class="btn ghost" id="backBtn">æˆ»ã‚‹</button>
      <button class="btn primary" id="nextBtn" disabled>æ¬¡ã¸ï¼ˆåå‰ã‚’ä»˜ã‘ã‚‹ï¼‰</button>
    </div>

    <!-- JSãŒå£Šã‚Œã¦ã‚‚é€²ã‚ã‚‹ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ -->
    <div class="fallback" id="fallback">
      <p>é¸æŠè‚¢ãŒè¡¨ç¤ºã•ã‚Œãªã„å ´åˆã¯ã“ã¡ã‚‰ã‹ã‚‰ï¼š</p>
      <a href="naming.html?seed=apple">ğŸ ãƒªãƒ³ã‚´ã‚¿ã‚¤ãƒ—ã§é€²ã‚€</a>
      <a href="naming.html?seed=leaf">ğŸƒ è‘‰ã£ã±ã‚¿ã‚¤ãƒ—ã§é€²ã‚€</a>
      <a href="naming.html?seed=paint">ğŸ¨ é’ã®çµµã®å…·ã§é€²ã‚€</a>
      <a href="naming.html?seed=grape">ğŸ‡ ãƒ–ãƒ‰ã‚¦ã§é€²ã‚€</a>
    </div>
  </div>

  <!-- ä¿å­˜ã‚’åˆæœŸåŒ–ï¼ˆè¡¨ç¤ºãŒãŠã‹ã—ã„æ™‚ã«ä½¿ã†ã¨å¾©æ—§ã—ã‚„ã™ã„ï¼‰ -->
  <button class="reset" id="resetBtn">ä¿å­˜ã‚’ãƒªã‚»ãƒƒãƒˆ</button>

<script>
(function(){
  // --- runï¼ˆå‘¨å›ã‚«ã‚¦ãƒ³ã‚¿ï¼‰ã‚’å®‰å…¨ã«å–å¾— ---
  function safeInt(key, def){
    var v = localStorage.getItem(key);
    var n = parseInt(v,10);
    return isNaN(n)? def : n;
  }
  var run = safeInt('run',1);

  // --- è¡¨ç¤ºãƒ†ã‚­ã‚¹ãƒˆï¼ˆ2é€±ç›®ä»¥é™ã¯4ç¨®é¡ï¼‰ ---
  if(run >= 2){
    document.getElementById('title').textContent = 'ã‚¿ãƒã‚’é¸ã‚“ã§ãã ã•ã„ï¼ˆ2é€±ç›®ã¯4ç¨®é¡ï¼‰';
    document.getElementById('lead').textContent  = 'ãƒªãƒ³ã‚´ï¼è‘‰ã£ã±ï¼é’ã®çµµã®å…·ï¼ãƒ–ãƒ‰ã‚¦ã‹ã‚‰é¸ã¹ã¾ã™ã€‚';
  }

  // --- é¸æŠè‚¢ãƒªã‚¹ãƒˆï¼ˆå¸¸ã«è¡¨ç¤ºã€‚ä¿å­˜æ¸ˆã¿ã§ã‚‚â€œå¤‰æ›´OKâ€ï¼‰ ---
  var options = [
    {type:'apple', emoji:'ğŸ', name:'ãƒªãƒ³ã‚´ã‚¿ã‚¤ãƒ—', desc:'ãƒãƒ©ãƒ³ã‚¹ãŒã‚ˆãã€ç´ ç›´ã«è‚²ã¡ã‚„ã™ã„ã€‚'},
    {type:'leaf',  emoji:'ğŸƒ', name:'è‘‰ã£ã±ã‚¿ã‚¤ãƒ—', desc:'è‡ªç”±å¥”æ”¾ã€‚éŠã¶ã®ãŒå¤§å¥½ãã€‚'}
  ];
  if(run>=2){
    options.push(
      {type:'paint', emoji:'ğŸ¨', name:'é’ã®çµµã®å…·', desc:'è¡¨ç¾æ´¾ã€‚æ°—åˆ†å±‹ã ã‘ã©å‰µé€ çš„ã€‚'},
      {type:'grape', emoji:'ğŸ‡', name:'ãƒ–ãƒ‰ã‚¦',     desc:'ãƒŸã‚¹ãƒ†ãƒªã‚¢ã‚¹ã€‚æ·±ãè€ƒãˆã‚‹ã‚¿ã‚¤ãƒ—ã€‚'}
    );
  }

  // --- DOMã«å·®ã—è¾¼ã¿ ---
  var choicesEl = document.getElementById('choices');
  var html='';
  options.forEach(function(o){
    html += '<div class="card" data-type="'+o.type+'" tabindex="0" aria-label="'+o.name+'">'
          + '  <div class="emoji">'+o.emoji+'</div>'
          + '  <div><div class="name">'+o.name+'</div><div class="desc">'+o.desc+'</div></div>'
          + '</div>';
  });
  choicesEl.innerHTML = html;

  // --- é¸æŠæŒ™å‹•ï¼ˆä¿å­˜ãŒã‚ã£ã¦ã‚‚å¸¸ã«å¤‰æ›´å¯ï¼‰ ---
  var current = localStorage.getItem('seedType') || null;
  function render(){
    Array.from(choicesEl.children).forEach(function(c){
      c.classList.toggle('selected', c.getAttribute('data-type')===current);
    });
    document.getElementById('nextBtn').disabled = !current;
  }
  choicesEl.addEventListener('click', function(e){
    var t=e.target; while(t && !t.classList.contains('card')) t=t.parentNode;
    if(!t) return; current=t.getAttribute('data-type'); render();
  });
  choicesEl.addEventListener('keydown', function(e){
    if((e.key==='Enter'||e.key===' ') && e.target.classList.contains('card')){
      current=e.target.getAttribute('data-type'); render();
    }
  });
  document.getElementById('backBtn').addEventListener('click', function(){ history.back(); });
  document.getElementById('nextBtn').addEventListener('click', function(){
    if(!current) return;
    try{
      localStorage.setItem('seedType', current);
      // 2é€±ç›®ãƒãƒƒãƒ”ãƒ³ã‚°ã¯ naming.html å´ã§ macaronColor ã«åæ˜ ã•ã‚Œã¾ã™
    }catch(_){}
    location.href='naming.html';
  });

  // --- æˆåŠŸã—ãŸã‚‰ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯éè¡¨ç¤º ---
  document.getElementById('fallback').classList.add('hidden');

  // --- ä¿å­˜ãƒªã‚»ãƒƒãƒˆï¼ˆè¡¨ç¤ºãŒãŠã‹ã—ã„æ™‚ã®å¾©æ—§ç”¨ï¼‰ ---
  document.getElementById('resetBtn').addEventListener('click', function(){
    ['seedType','macaronColor','tanePoints','whoai_xp','whoai_phase',
     'PLAYER_NAME','CHAR_NAME','whoai_name','whoai_player_name'].forEach(function(k){
      try{ localStorage.removeItem(k); }catch(_){}
    });
    alert('ä¿å­˜ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¾ã™ã€‚');
    location.reload();
  });

  // åˆæœŸãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼ˆä¿å­˜æ¸ˆã¿ã® seedType ã‚’åæ˜ ï¼‰
  render();
})();
</script>
</body>
</html>
